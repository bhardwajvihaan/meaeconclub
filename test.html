<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MEA Economics Club - AP Micro 2.1–2.4 Quiz</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    /* [Your existing CSS here] */
    #progressBarContainer { width:100%; background:#ddd; border-radius:8px; margin-bottom:1.5rem }
    #progressBar { height:20px; background:#4caf50; width:0 }
  </style>
</head>
<body>
  <header>
    <img src="MEA%20Economics%20Club%20Logo%20(original).png" alt="MEA Logo">
    <h1>AP Microeconomics Quiz: Units 2.1–2.4</h1>
  </header>

  <form id="quizForm">
    <div id="progressBarContainer"><div id="progressBar"></div></div>
    <div id="quiz"></div>
    <button type="submit">Submit Quiz</button>
    <div id="result" class="result"></div>
    <button id="downloadPdf" style="display:none; margin-top:20px;">Download Report as PDF</button>
  </form>

  <script>
    const { jsPDF } = window.jspdf;
    const quizDiv = document.getElementById("quiz");
    const progressBar = document.getElementById("progressBar");
    const downloadPdfBtn = document.getElementById("downloadPdf");

    const questions = [
      { q: "Which shifts demand for smartphones right?", options:["An increase in price","A rise in consumer income (normal good)","An increase in production costs","Higher interest rates"], correct:"A rise in consumer income (normal good)", explanation: "Higher income increases demand for normal goods." },
      { q: "Which causes leftward shift of wheat supply?", options:["Improved technology","Government subsidy","Drought","Lower production taxes"], correct:"Drought", explanation: "Drought reduces production capacity, decreasing supply." },
      { q: "PED can never be:", options:["Negative","Positive","Zero","Infinity"], correct:"Positive", explanation: "PED is negative due to inverse price–quantity relationship." },
      { q: "If Qd 60→75 as price falls $10→$8, PED?", type:"number", correct:"1.25", explanation: "PED = (%ΔQd)/(%)ΔP = (25%)/(–20%) = |–1.25| = 1.25." },
      { q: "Which good likely has elastic demand?", options:["Salt","Electricity","Luxury watches","Gasoline"], correct:"Luxury watches", explanation: "Luxury goods have many substitutes; demand is more elastic." },
      { q: "A price ceiling leads to:", options:["Surplus","Shortage","Equilibrium","Higher prices"], correct:"Shortage", explanation: "Ceilings below equilibrium price cause shortages." },
      { q: "If PES = 0.8, supply is:", options:["Elastic","Perfectly elastic","Inelastic","Unit elastic"], correct:"Inelastic", explanation: "PES < 1 means supply is inelastic." },
      { q: "A decrease in input costs affects supply by:", options:["Shifting it left","Making it steeper","Shifting it right","No effect"], correct:"Shifting it right", explanation: "Lower input cost shifts supply curve right." },
      { q: "What is PES if P rises 20% to 25 and Qs 100→120?", type:"number", correct:"1", explanation: "PES = (%ΔQs)/(%)ΔP = (20%)/(20%) = 1." },
      { q: "When demand is inelastic and price rises, total revenue:", options:["Increases","Decreases","Stays same","Becomes zero"], correct:"Increases", explanation: "Inelastic demand means consumers still buy; revenue rises." },
      { q: "Formula for PED?", options:["%ΔP / %ΔQd","%ΔQd / %ΔP","%ΔQd × %ΔP","%ΔQd - %ΔP"], correct:"%ΔQd / %ΔP", explanation: "PED measures responsiveness: percent change in Qd ÷ percent change in P." },
      { q: "If 20% price increase causes 40% drop Qd, PED is:", type:"number", correct:"2", explanation: "PED = 40/20 = 2 (elastic)." },
      { q: "A product with perfectly elastic supply has curve:", options:["Vertical","Horizontal","Upward sloping","U-shaped"], correct:"Horizontal", explanation: "Perfectly elastic supply is horizontal." },
      { q: "A decrease in consumer income affects which part?", options:["Supply","Demand","Equilibrium","Price floor"], correct:"Demand", explanation: "Income affects demand, not supply directly." },
      { q: "If price drops 10% and Qd rises 15%, PED is:", type:"number", correct:"1.5", explanation: "PED = 15/10 = 1.5." },
      { q: "When PES > 1, supply is:", options:["Elastic","Inelastic","Unit elastic","Perfectly inelastic"], correct:"Elastic", explanation: "PES > 1 means elastic supply." },
      { q: "A rightward shift in demand leads to:", options:["Lower price","Lower quantity","Higher equilibrium price","Surplus"], correct:"Higher equilibrium price", explanation: "Higher demand raises both price and quantity." },
      { q: "What is PES if Qs increases 50% due to 25% price rise?", type:"number", correct:"2", explanation: "PES = 50/25 = 2." },
      { q: "Which factor makes supply more elastic?", options:["Longer time period","Few substitutes","High necessity","Inelastic demand"], correct:"Longer time period", explanation: "More time allows firms to adjust, increasing elasticity." },
      { q: "PED of zero implies:", options:["Perfectly elastic","Unit elastic","Perfectly inelastic","Elastic"], correct:"Perfectly inelastic", explanation: "PED = 0 means quantity doesn’t change with price." },
      { q: "Which market type likely shows inelastic demand?", options:["Luxury cars","Insulin","Jewelry","Entertainment"], correct:"Insulin", explanation: "Insulin is life-saving; demand doesn’t change with price." },
      { q: "If subsidy given, supply curve:", options:["Shifts left","Shifts right","Becomes vertical","Does not change"], correct:"Shifts right", explanation: "Subsidies lower costs, increasing supply (right shift)." },
      { q: "If Qd falls 200→180 and price rises $10→$11, PED is:", type:"number", correct:"1", explanation: "%ΔQd = –10%; %ΔP = 10%; PED = 1." },
      { q: "What happens when supply is inelastic and demand increases?", options:["Large quantity increase","No price change","Small quantity change, large price rise","Equilibrium unchanged"], correct:"Small quantity change, large price rise", explanation: "Inelastic supply yields big price impact with small output change." },
      { q: "Which determinant does NOT affect demand?", options:["Income","Tastes","Input prices","Price of substitutes"], correct:"Input prices", explanation: "Input prices affect supply, not demand." }
    ];

    // build quiz
    questions.forEach((q, i) => {
      const d = document.createElement("div"); d.className = "question";
      let html = `<p>${i+1}. ${q.q}</p>`;
      if (q.options) q.options.forEach(opt => html += `<label><input type="radio" name="q${i}" value="${opt}" required> ${opt}</label><br>`);
      else if (q.type === "number") html += `<input type="number" name="q${i}" step="any" required>`;
      d.innerHTML = html;
      quizDiv.appendChild(d);
    });

    // progress tracking
    quizDiv.addEventListener("input", () => {
      const answered = quizDiv.querySelectorAll("input:checked,input[type=number]").length;
      progressBar.style.width = Math.round(answered/questions.length*100) + "%";
    });

    // on submit
    document.getElementById("quizForm").addEventListener("submit", e => {
      e.preventDefault();
      let score = 0;
      const results = [];
      questions.forEach((q,i) => {
        const ua = document.forms.quizForm[`q${i}`].value;
        const correct = ua.trim().toLowerCase() === q.correct.toString().trim().toLowerCase();
        if (correct) score++;
        results.push({number:i+1, question:q.q, selected:ua, correctAns:q.correct, correct, explanation:q.explanation});
      });

      const rd = document.getElementById("result");
      rd.innerHTML = `<p>Your score: ${score} / ${questions.length}</p>`;
      results.forEach(r => {
        rd.innerHTML += `
        <p><strong>Q${r.number}:</strong> ${r.correct ? '<span class="correct">Correct</span>' : '<span class="incorrect">Incorrect</span>'}<br>
        Your answer: <span class="${r.correct ? 'correct' : 'incorrect'}">${r.selected}</span><br>
        Correct answer: <span class="correct">${r.correctAns}</span><br>
        ${!r.correct ? `<em>Explanation:</em> ${r.explanation}` : ''}</p>`;
      });

      downloadPdfBtn.style.display = 'block';
      downloadPdfBtn.onclick = () => {
        const doc = new jsPDF();
        doc.setFontSize(14);
        doc.text(`Score: ${score} / ${questions.length}`, 10, 10);
        let y = 20;
        results.forEach(r => {
          doc.setTextColor(0);
          doc.text(`${r.number}. ${r.question}`, 10, y); y+=7;
          if (!r.correct) {
            doc.setTextColor(255,0,0);
            doc.text(`Your: ${r.selected}`, 10, y); y+=7;
            doc.setTextColor(0,128,0);
            doc.text(`Correct: ${r.correctAns}`, 10, y); y+=7;
            doc.setTextColor(0);
            doc.text(`Explanation: ${r.explanation}`, 10, y); y+=10;
          } else {
            doc.setTextColor(0,128,0);
            doc.text(`Correct`, 10, y); y+=10;
          }
          if (y > 270){ doc.addPage(); y=20; }
        });
        doc.save("quiz_report.pdf");
      };
    });
  </script>
</body>
</html>
